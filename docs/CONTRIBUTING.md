# 開発者向け情報
KCMSの開発を行う人向けのドキュメントです.

## インストールが必要なもの

- 実行環境: [bun](https://bun.sh/) (latest)

## サーバーを動作させる

まず初めに、データ保存用の`data.json`を用意してください.

```json
{
  "entry": [],
  "match": []
}
```

**依存パッケージをインストールしてください.**

```bash
bun i
```

**サーバーの起動 (プロダクション向け)**

```bash
bun run build
bun start
```

**サーバーの起動 (開発向け)**
ソースコードに変更があったら自動的に再起動されます

```bash
bun dev
```

## プログラムを書く

### ディレクトリ構造
概ね以下のような構造になっています (2024, 5月16日現在)

```
. (プロジェクトルート)
 - README.md
 - docs/ 各種ドキュメント
 - pkg/  パッケージルート
    - entry/ エントリー関連
    - id/    ID生成関連
    - match/ 試合関連
    - testData/ テスト用データ
    - main.ts エントリーポイント
```

#### `pkg/`以下の構造
pkg以下のディレクトリはパッケージとも呼ばれます。  
役割は以下のとおりです
- entry
  - エントリー(参加登録)周りの実装
- id
  - ID生成周りの実装
- match
  - 試合管理の実装
- testData
  - テスト用のデータ置き場

#### パッケージ内部の構造
それぞれのパッケージ(`id`と`testData`は別です)は以下のような構造になっています  
- adaptor/
  - 外部のシステム(主にデータベース)を呼び出す実装が置かれている
- model/
  - モデルの定義、外部システムのインタフェースが置かれている
- service/
  - サービス(主な処理)が置かれている
- controller.ts
  - APIの処理が置かれている
- main.ts
  - エントリーポイント、APIの定義が置かれている

